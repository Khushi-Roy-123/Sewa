import React, { createContext, useContext, useState, useMemo } from 'react';

const translations = {
  en: {
    // Auth
    login: 'Login',
    signup: 'Sign Up',
    emailAddress: 'Email Address',
    password: 'Password',
    fullName: 'Full Name',
    confirmPassword: 'Confirm Password',
    forgotPassword: 'Forgot Password?',
    rememberMe: 'Remember me',
    loginToYourAccount: 'Login to your account',
    dontHaveAccount: "Don't have an account?",
    createAnAccount: 'Create an account',
    alreadyHaveAccount: 'Already have an account?',
    validation_emailRequired: 'Email is required',
    validation_emailInvalid: 'Invalid email format',
    validation_passwordRequired: 'Password is required',
    validation_passwordLength: 'Password must be at least 6 characters',
    validation_nameRequired: 'Full name is required',
    validation_confirmPasswordRequired: 'Please confirm your password',
    validation_passwordsNoMatch: 'Passwords do not match',
    auth_loginSuccess: 'Login successful! Redirecting...',
    auth_loginError: 'Invalid credentials. Please try again.',
    auth_signupSuccess: 'Account created successfully! Please log in.',
    auth_signupError: 'An error occurred during sign up.',
    auth_resetPasswordEmailSent: 'Password reset email sent!',
    logout: 'Logout',
    language: 'Language',
    
    // Layout / Navigation
    dashboard: 'Dashboard',
    symptomChecker: 'Symptom Checker',
    appointments: 'Appointments',
    medications: 'Medications',
    records: 'Records',
    profile: 'Profile',
    vitalSigns: 'Vital Signs',
    mentalHealth: 'Mental Health',
    drugPrices: 'Drug Prices',

    // Dashboard
    welcomeBack: 'Welcome back, {name}',
    healthSummaryToday: "Here's your health summary for today.",
    upcomingAppointment: 'Upcoming Appointment',
    appointmentTomorrow: 'Tomorrow at 10:30 AM',
    nextMedication: 'Next Medication',
    checkingMedications: 'Checking...',
    addMedicationPrompt: 'Add a medication',
    noMedicationsToday: 'No more doses today',
    dueAtTime: 'Due at {time}',
    quickActions: 'Quick Actions',
    symptomCheckerActionTitle: 'Check Symptoms',
    symptomCheckerActionDesc: 'Describe your symptoms for an AI-powered analysis.',
    uploadRecordActionTitle: 'Upload a Record',
    uploadRecordActionDesc: 'Scan and analyze your medical documents.',
    monitorVitalsActionTitle: 'Monitor Vitals',
    monitorVitalsActionDesc: 'Connect a device to track your vital signs.',
    
    // Symptom Checker & Recommendations
    describeSymptomsPrompt: 'Describe your symptoms clearly for an accurate AI-powered analysis.',
    symptoms: 'Symptoms',
    symptomsPlaceholder: 'e.g., I have a persistent cough, a slight fever, and a headache...',
    selectLanguage: 'Select Language',
    voiceInput: 'Voice Input',
    startRecording: 'Start Recording',
    stopRecording: 'Stop Recording',
    recording: 'Recording...',
    submitSymptoms: 'Get Recommendations',
    recommendationsTitle: 'Specialist Recommendations',
    recommendationsSubtitle: 'Based on your symptoms, we suggest consulting with the following specialists.',
    loadingRecommendations: 'Analyzing your symptoms...',
    errorRecommendations: 'Sorry, we couldn’t get recommendations at this time. Please try again later.',
    reasonForRecommendation: 'Why we recommend them',
    sampleDoctors: 'Sample Doctors',
    bookAppointment: 'Book an Appointment',
    deepAnalysisTitle: "In-Depth Symptom Analysis",
    disclaimerTitle: "Important Disclaimer",
    disclaimerText: "This analysis is generated by an AI and is for informational purposes only. It is not a substitute for professional medical advice, diagnosis, or treatment. Always seek the advice of your physician or other qualified health provider with any questions you may have regarding a medical condition.",
    potentialConditions: "Potential Conditions",
    likelihood: "Likelihood",
    severity: "Severity Assessment",
    recommendedNextSteps: "Recommended Next Steps",
    questionsForDoctor: "Questions for Your Doctor",
    sources: "Information Sources",
    severityUrgent: "Urgent: Seek immediate attention",
    severityRoutine: "Routine: Consult a doctor soon",
    severityMonitor: "Monitor: Observe symptoms at home",
    getDeeperAnalysis: "Get Deeper Analysis",
    analyzing: "Analyzing...",

    // Records
    uploadRecordTitle: 'Upload Medical Record',
    uploadRecordSubtitle: 'Upload or take a picture of your document for OCR extraction.',
    uploadFromFile: 'Upload from File',
    useCamera: 'Use Camera',
    capture: 'Capture',
    closeCamera: 'Close Camera',
    imagePreview: 'Image Preview',
    extractText: 'Extract Text from Image',
    extractingText: 'Extracting...',
    extractionError: 'Failed to extract text. Please try a clearer image.',
    extractedText: 'Extracted Text',
    analyzeAndTranslate: 'Analyze & Translate',
    
    analyzedRecordTitle: 'Analyzed Medical Record',
    analyzedRecordSubtitle: 'Below is the translated text with critical information highlighted.',
    selectTranslationLanguage: 'Translate to:',
    translationLoading: 'Translating and analyzing...',
    translationError: 'An error occurred during analysis. Please try again.',
    translatedText: 'Translated Text',
    originalText: 'Original Text',
    
    // Medications
    addMedication: 'Add Medication',
    editMedication: 'Edit Medication',
    medicationName: 'Medication Name',
    dosage: 'Dosage',
    status: 'Status',
    active: 'Active',
    inactive: 'Inactive',
    reminderTimes: 'Reminder Times (24h format)',
    addTime: 'Add Time',
    daysOfWeek: 'Days of the Week',
    save: 'Save',
    cancel: 'Cancel',
    delete: 'Delete',
    notificationPermission: 'Enable notifications to receive medication reminders.',
    notificationsEnabled: 'Notifications Enabled',
    notificationsEnabledDesc: 'You will receive reminders for your medications.',
    notificationsBlocked: 'Notifications Blocked',
    notificationsBlockedDesc: 'To receive medication reminders, please enable notifications in your browser settings.',
    getMedicationReminders: 'Get Medication Reminders',
    getMedicationRemindersDesc: 'Enable notifications to get timely alerts.',
    enableNotifications: 'Enable Notifications',
    
    // Drug Prices
    drugPricesTitle: 'Drug Price Comparison',
    drugPricesSubtitle: 'Search for a medication to compare brand name and generic prices.',
    searchDrugPlaceholder: 'Enter a drug name (e.g., Lipitor)',
    search: 'Search',
    searching: 'Searching...',
    errorDrugPrices: 'Could not fetch price data. Please check the drug name and try again.',
    brandNamePrice: 'Brand Name Price Comparison',
    genericAlternatives: 'Generic Alternatives',
    manufacturer: 'Manufacturer',
    potentialSavings: 'Savings',
    
    // Vitals Monitor
    vitalsTitle: 'Vital Signs Monitor',
    vitalsSubtitle: 'Connect a Bluetooth-enabled device to monitor your vitals in real-time.',
    statusDisconnected: 'Disconnected',
    statusConnecting: 'Connecting',
    statusConnected: 'Connected',
    statusError: 'Error',
    connectDevice: 'Connect Device',
    disconnectDevice: 'Disconnect',
    heartRate: 'Heart Rate',
    bpm: 'BPM',
    bloodPressure: 'Blood Pressure',
    oxygenSaturation: 'SpO2',
    sendEmergencyAlert: 'Send Emergency Alert',
    sendingAlert: 'Sending...',
    alertSent: 'Alert Sent!',
    emergencyMessagePreview: 'The following message has been sent to your emergency contact:',
    alertGenerationError: 'Failed to generate the alert message.',
    resetZoom: 'Reset Zoom',
    
    // Mental Health
    mentalHealthTitle: 'Mental Wellness Hub',
    mentalHealthSubtitle: 'Tools and resources to support your mental well-being.',
    moodTrackerTitle: "How are you feeling today?",
    moodRecorded: "Thanks for sharing!",
    yourMoodThisWeek: 'Your Mood This Week',
    meditationTitle: "Quick Meditation",
    meditationDesc: "Take a 5-minute break to relax and recenter.",
    aiCompanionTitle: "AI Companion",
    aiCompanionPlaceholder: "Type your message...",
    aiCompanionSend: "Send",
    aiCompanionTyping: 'Companion is typing...',
    suggestMeditationAction: 'Start 5-Minute Meditation',
    moodStarterHappy: "That's great to hear! What's making you feel happy today?",
    moodStarterGood: "Glad to hear you're feeling good. What's been the highlight of your day?",
    moodStarterNeutral: "Thanks for checking in. Is there anything on your mind?",
    moodStarterWorried: "I'm sorry to hear you're feeling worried. Would you like to talk about what's on your mind?",
    moodStarterSad: "I'm here for you. Sometimes it helps to talk about what's making you feel sad.",
    aiCompanionSystemInstruction: "You are a friendly and supportive AI wellness companion. Your goal is to provide a safe and empathetic space for users to express their feelings. You are not a medical professional and must not provide medical advice. If the user expresses feelings of stress or anxiety, you can use the 'suggestMeditation' tool to offer a guided meditation session. Keep your responses concise and caring.",
    myJournal: "My Journal",
    journalPlaceholder: "Write about your day, your thoughts, or anything on your mind...",
    saveEntry: "Save Entry",
    editEntry: "Edit Entry",
    deleteEntry: "Delete",
    readMore: "Read More",
    readLess: "Read Less",
    deleteConfirmation: "Are you sure you want to delete this entry?",
  },
  es: {
    // Auth
    login: 'Iniciar Sesión',
    signup: 'Registrarse',
    emailAddress: 'Correo Electrónico',
    password: 'Contraseña',
    fullName: 'Nombre Completo',
    confirmPassword: 'Confirmar Contraseña',
    forgotPassword: '¿Olvidaste tu contraseña?',
    rememberMe: 'Recuérdame',
    loginToYourAccount: 'Inicia sesión en tu cuenta',
    dontHaveAccount: '¿No tienes una cuenta?',
    createAnAccount: 'Crea una cuenta',
    alreadyHaveAccount: '¿Ya tienes una cuenta?',
    validation_emailRequired: 'El correo es requerido',
    validation_emailInvalid: 'Formato de correo inválido',
    validation_passwordRequired: 'La contraseña es requerida',
    validation_passwordLength: 'La contraseña debe tener al menos 6 caracteres',
    validation_nameRequired: 'El nombre completo es requerido',
    validation_confirmPasswordRequired: 'Por favor confirma tu contraseña',
    validation_passwordsNoMatch: 'Las contraseñas no coinciden',
    auth_loginSuccess: '¡Inicio de sesión exitoso! Redirigiendo...',
    auth_loginError: 'Credenciales inválidas. Inténtalo de nuevo.',
    auth_signupSuccess: '¡Cuenta creada exitosamente! Por favor, inicia sesión.',
    auth_signupError: 'Ocurrió un error durante el registro.',
    auth_resetPasswordEmailSent: '¡Correo de restablecimiento de contraseña enviado!',
    logout: 'Cerrar Sesión',
    language: 'Idioma',
    
    // Layout / Navigation
    dashboard: 'Panel',
    symptomChecker: 'Verificador de Síntomas',
    appointments: 'Citas',
    medications: 'Medicamentos',
    records: 'Registros',
    profile: 'Perfil',
    vitalSigns: 'Signos Vitales',
    mentalHealth: 'Salud Mental',
    drugPrices: 'Precios de Medicamentos',

    // Dashboard
    welcomeBack: 'Bienvenido de nuevo, {name}',
    healthSummaryToday: 'Aquí está tu resumen de salud para hoy.',
    upcomingAppointment: 'Próxima Cita',
    appointmentTomorrow: 'Mañana a las 10:30 AM',
    nextMedication: 'Próximo Medicamento',
    checkingMedications: 'Comprobando...',
    addMedicationPrompt: 'Añadir un medicamento',
    noMedicationsToday: 'No más dosis por hoy',
    dueAtTime: 'Vence a las {time}',
    quickActions: 'Acciones Rápidas',
    symptomCheckerActionTitle: 'Verificar Síntomas',
    symptomCheckerActionDesc: 'Describe tus síntomas para un análisis con IA.',
    uploadRecordActionTitle: 'Subir un Registro',
    uploadRecordActionDesc: 'Escanea y analiza tus documentos médicos.',
    monitorVitalsActionTitle: 'Monitorear Signos Vitales',
    monitorVitalsActionDesc: 'Conecta un dispositivo para seguir tus signos vitales.',
    
    // Symptom Checker & Recommendations
    describeSymptomsPrompt: 'Describe tus síntomas claramente para un análisis preciso con IA.',
    symptoms: 'Síntomas',
    symptomsPlaceholder: 'Ej: Tengo una tos persistente, fiebre leve y dolor de cabeza...',
    selectLanguage: 'Seleccionar Idioma',
    voiceInput: 'Entrada de Voz',
    startRecording: 'Empezar a Grabar',
    stopRecording: 'Detener Grabación',
    recording: 'Grabando...',
    submitSymptoms: 'Obtener Recomendaciones',
    recommendationsTitle: 'Recomendaciones de Especialistas',
    recommendationsSubtitle: 'Basado en tus síntomas, sugerimos consultar con los siguientes especialistas.',
    loadingRecommendations: 'Analizando tus síntomas...',
    errorRecommendations: 'Lo sentimos, no pudimos obtener recomendaciones en este momento. Inténtalo de nuevo más tarde.',
    reasonForRecommendation: 'Por qué los recomendamos',
    sampleDoctors: 'Doctores de Ejemplo',
    bookAppointment: 'Reservar una Cita',
    deepAnalysisTitle: "Análisis Profundo de Síntomas",
    disclaimerTitle: "Aviso Importante",
    disclaimerText: "Este análisis es generado por una IA y es solo para fines informativos. No sustituye el consejo, diagnóstico o tratamiento médico profesional. Siempre busca el consejo de tu médico u otro proveedor de salud calificado con cualquier pregunta que puedas tener sobre una condición médica.",
    potentialConditions: "Posibles Condiciones",
    likelihood: "Probabilidad",
    severity: "Evaluación de Severidad",
    recommendedNextSteps: "Próximos Pasos Recomendados",
    questionsForDoctor: "Preguntas para tu Doctor",
    sources: "Fuentes de Información",
    severityUrgent: "Urgente: Busca atención inmediata",
    severityRoutine: "Rutina: Consulta a un médico pronto",
    severityMonitor: "Monitoreo: Observa los síntomas en casa",
    getDeeperAnalysis: "Obtener Análisis Profundo",
    analyzing: "Analizando...",

    // Records
    uploadRecordTitle: 'Subir Registro Médico',
    uploadRecordSubtitle: 'Sube o toma una foto de tu documento para extracción OCR.',
    uploadFromFile: 'Subir desde Archivo',
    useCamera: 'Usar Cámara',
    capture: 'Capturar',
    closeCamera: 'Cerrar Cámara',
    imagePreview: 'Vista Previa de Imagen',
    extractText: 'Extraer Texto de Imagen',
    extractingText: 'Extrayendo...',
    extractionError: 'Fallo al extraer texto. Por favor, intenta con una imagen más clara.',
    extractedText: 'Texto Extraído',
    analyzeAndTranslate: 'Analizar y Traducir',

    analyzedRecordTitle: 'Registro Médico Analizado',
    analyzedRecordSubtitle: 'A continuación, el texto traducido con información crítica resaltada.',
    selectTranslationLanguage: 'Traducir a:',
    translationLoading: 'Traduciendo y analizando...',
    translationError: 'Ocurrió un error durante el análisis. Por favor, inténtalo de nuevo.',
    translatedText: 'Texto Traducido',
    originalText: 'Texto Original',

    // Medications
    addMedication: 'Añadir Medicamento',
    editMedication: 'Editar Medicamento',
    medicationName: 'Nombre del Medicamento',
    dosage: 'Dosis',
    status: 'Estado',
    active: 'Activo',
    inactive: 'Inactivo',
    reminderTimes: 'Horas de Recordatorio (24h)',
    addTime: 'Añadir Hora',
    daysOfWeek: 'Días de la Semana',
    save: 'Guardar',
    cancel: 'Cancelar',
    delete: 'Eliminar',
    notificationPermission: 'Habilita las notificaciones para recibir recordatorios de medicamentos.',
    notificationsEnabled: 'Notificaciones Habilitadas',
    notificationsEnabledDesc: 'Recibirás recordatorios para tus medicamentos.',
    notificationsBlocked: 'Notificaciones Bloqueadas',
    notificationsBlockedDesc: 'Para recibir recordatorios, por favor habilita las notificaciones en la configuración de tu navegador.',
    getMedicationReminders: 'Recibir Recordatorios de Medicamentos',
    getMedicationRemindersDesc: 'Habilita las notificaciones para recibir alertas a tiempo.',
    enableNotifications: 'Habilitar Notificaciones',


    // Drug Prices
    drugPricesTitle: 'Comparación de Precios de Medicamentos',
    drugPricesSubtitle: 'Busca un medicamento para comparar precios de marca y genéricos.',
    searchDrugPlaceholder: 'Ingresa un nombre de medicamento (ej: Lipitor)',
    search: 'Buscar',
    searching: 'Buscando...',
    errorDrugPrices: 'No se pudieron obtener los datos de precios. Revisa el nombre del medicamento e inténtalo de nuevo.',
    brandNamePrice: 'Comparación de Precios de Marca',
    genericAlternatives: 'Alternativas Genéricas',
    manufacturer: 'Fabricante',
    potentialSavings: 'Ahorro Potencial',

    // Vitals Monitor
    vitalsTitle: 'Monitor de Signos Vitales',
    vitalsSubtitle: 'Conecta un dispositivo Bluetooth para monitorear tus signos vitales en tiempo real.',
    statusDisconnected: 'Desconectado',
    statusConnecting: 'Conectando',
    statusConnected: 'Conectado',
    statusError: 'Error',
    connectDevice: 'Conectar Dispositivo',
    disconnectDevice: 'Desconectar',
    heartRate: 'Frecuencia Cardíaca',
    bpm: 'LPM',
    bloodPressure: 'Presión Arterial',
    oxygenSaturation: 'Saturación de Oxígeno',
    sendEmergencyAlert: 'Enviar Alerta de Emergencia',
    sendingAlert: 'Enviando...',
    alertSent: '¡Alerta Enviada!',
    emergencyMessagePreview: 'El siguiente mensaje ha sido enviado a tu contacto de emergencia:',
    alertGenerationError: 'Fallo al generar el mensaje de alerta.',
    resetZoom: 'Restablecer Zoom',
    
    // Mental Health
    mentalHealthTitle: 'Centro de Bienestar Mental',
    mentalHealthSubtitle: 'Herramientas y recursos para apoyar tu bienestar mental.',
    moodTrackerTitle: '¿Cómo te sientes hoy?',
    moodRecorded: '¡Gracias por compartir!',
    yourMoodThisWeek: 'Tu Humor Esta Semana',
    meditationTitle: 'Meditación Rápida',
    meditationDesc: 'Tómate un descanso de 5 minutos para relajarte y centrarte.',
    aiCompanionTitle: 'Compañero IA',
    aiCompanionPlaceholder: 'Escribe tu mensaje...',
    aiCompanionSend: 'Enviar',
    aiCompanionTyping: 'El compañero está escribiendo...',
    suggestMeditationAction: 'Comenzar Meditación de 5 Minutos',
    moodStarterHappy: '¡Qué bueno escuchar eso! ¿Qué te hace sentir feliz hoy?',
    moodStarterGood: 'Me alegra que te sientas bien. ¿Qué ha sido lo mejor de tu día?',
    moodStarterNeutral: 'Gracias por registrar tu estado. ¿Hay algo en lo que estés pensando?',
    moodStarterWorried: 'Siento escuchar que te sientes preocupado. ¿Te gustaría hablar sobre lo que tienes en mente?',
    moodStarterSad: 'Estoy aquí para ti. A veces ayuda hablar de lo que te hace sentir triste.',
    aiCompanionSystemInstruction: "Eres un compañero de bienestar IA amigable y solidario. Tu objetivo es proporcionar un espacio seguro y empático para que los usuarios expresen sus sentimientos. No eres un profesional médico y no debes dar consejos médicos. Si el usuario expresa sentimientos de estrés o ansiedad, puedes usar la herramienta 'suggestMeditation' para ofrecer una sesión de meditación guiada. Mantén tus respuestas concisas y afectuosas.",
    myJournal: "Mi Diario",
    journalPlaceholder: "Escribe sobre tu día, tus pensamientos o cualquier cosa que tengas en mente...",
    saveEntry: "Guardar Entrada",
    editEntry: "Editar Entrada",
    deleteEntry: "Eliminar",
    readMore: "Leer Más",
    readLess: "Leer Menos",
    deleteConfirmation: "¿Estás seguro de que quieres eliminar esta entrada?",
  },
};

type Language = 'en' | 'es';

interface TranslationsContextType {
  language: Language;
  setLanguage: (language: Language) => void;
  t: (key: keyof typeof translations.en, params?: Record<string, string | number>) => string;
}

const TranslationsContext = createContext<TranslationsContextType | undefined>(undefined);

export const TranslationsProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
    const [language, setLanguage] = useState<Language>('en');

    const t = useMemo(() => (key: keyof typeof translations.en, params?: Record<string, string | number>): string => {
        let translation = translations[language][key] || translations.en[key];
        if (params) {
            Object.keys(params).forEach(paramKey => {
                translation = translation.replace(`{${paramKey}}`, String(params[paramKey]));
            });
        }
        return translation;
    }, [language]);

    const value = {
        language,
        setLanguage,
        t,
    };

    return React.createElement(TranslationsContext.Provider, { value }, children);
};

export const useTranslations = () => {
    const context = useContext(TranslationsContext);
    if (context === undefined) {
        throw new Error('useTranslations must be used within a TranslationsProvider');
    }
    return context;
};
